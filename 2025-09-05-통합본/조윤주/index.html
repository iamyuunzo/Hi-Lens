<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hi-PolicyLens - ì •ì±…/ê·œì œ ëª¨ë‹ˆí„°ë§</title>
  <link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif;
      background: #fafafa;
      color: #333;
      line-height: 1.6;
      overflow-x: hidden;
    }

    /* ë¡œê·¸ì¸ í˜ì´ì§€ ìŠ¤íƒ€ì¼ */
    .login-page {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      background: #f8f9fa;
    }

    .login-container {
      background: white;
      border-radius: 20px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.1);
      width: 90%;
      max-width: 450px;
      padding: 40px;
      text-align: center;
    }
    
    .logo {
      margin-bottom: 30px;
    }
    
    .logo h1 {
      color: #0f2e69;
      font-size: 28px;
      font-weight: 700;
      margin: 0;
    }
    
    .logo p {
      color: #6b7280;
      font-size: 14px;
      margin-top: 5px;
    }
    
    .hyundai-badge {
      display: inline-block;
      background: linear-gradient(135deg, #ff8c00, #ffa500);
      color: white;
      padding: 6px 12px;
      border-radius: 6px;
      font-weight: 600;
      font-size: 14px;
      margin-bottom: 10px;
    }
    
    .login-form {
      margin-top: 30px;
    }
    
    .form-group {
      margin-bottom: 20px;
      text-align: left;
    }
    
    .form-label {
      display: block;
      color: #374151;
      font-size: 14px;
      font-weight: 500;
      margin-bottom: 8px;
    }
    
    .form-input {
      width: 100%;
      padding: 12px 16px;
      border: 1px solid #e5e7eb;
      border-radius: 10px;
      font-size: 15px;
      font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif;
      transition: all 0.3s ease;
    }
    
    .form-input:focus {
      border-color: #dc8d32;
      outline: none;
      box-shadow: 0 0 0 3px rgba(220, 141, 50, 0.1);
    }
    
    .login-btn {
      background: linear-gradient(135deg, #dc8d32, #f4a942);
      color: white;
      border: none;
      width: 100%;
      padding: 14px;
      border-radius: 10px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif;
    }
    
    .login-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(220, 141, 50, 0.3);
    }
    
    .help-text {
      margin-top: 20px;
      color: #6b7280;
      font-size: 13px;
    }
    
    .help-text a {
      color: #dc8d32;
      text-decoration: none;
      font-weight: 500;
    }

    /* ë©”ì¸ ì•± ìŠ¤íƒ€ì¼ */
    /* ì‚¬ì´ë“œë°” */
    .sidebar {
      position: fixed;
      left: 0;
      top: 0;
      width: 320px;
      height: 100vh;
      background: white;
      color: #333;
      z-index: 1000;
      transform: translateX(-100%);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      display: flex;
      flex-direction: column;
      box-shadow: 2px 0 20px rgba(0,0,0,0.1);
    }

    .sidebar.active {
      transform: translateX(0);
      box-shadow: 2px 0 30px rgba(0,0,0,0.15);
    }

    .sidebar-header {
      padding: 25px 20px;
      border-bottom: 1px solid #e5e7eb;
      background: linear-gradient(135deg, #fafafa, #f8f9fa);
      position: relative;
    }

    .sidebar-logo h2 {
      color: #0f2e69;
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 5px;
    }

    .sidebar-subtitle {
      color: #6b7280;
      font-size: 12px;
    }

    .sidebar-close {
      position: absolute;
      top: 20px;
      right: 20px;
      background: none;
      border: none;
      color: #6b7280;
      font-size: 24px;
      cursor: pointer;
      padding: 5px;
      border-radius: 5px;
      transition: all 0.3s ease;
    }

    .sidebar-close:hover {
      background: #f3f4f6;
      color: #374151;
    }

    .new-chat-btn {
      margin: 20px;
      padding: 12px 20px;
      background: linear-gradient(135deg, #dc8d32, #f4a942);
      color: white;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s ease;
      transform: translateY(0);
      box-shadow: 0 2px 10px rgba(220, 141, 50, 0.2);
    }

    .new-chat-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 20px rgba(220, 141, 50, 0.3);
    }

    /* í™ˆ ë²„íŠ¼ ì¶”ê°€ */
    .home-btn {
      margin: 0 20px 10px 20px;
      padding: 12px 20px;
      background: white;
      color: #0f2e69;
      border: 1px solid #e5e7eb;
      border-radius: 10px;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.3s ease;
      text-align: center;
    }

    .home-btn:hover {
      background: #f8f9fa;
      border-color: #0f2e69;
      transform: translateY(-1px);
    }

    /* ëŒ€í™” íˆìŠ¤í† ë¦¬ */
    .conversation-history {
      flex: 1;
      padding: 0 20px;
      overflow-y: auto;
      scrollbar-width: thin;
      scrollbar-color: #d1d5db #f9fafb;
    }

    .conversation-history::-webkit-scrollbar {
      width: 6px;
    }

    .conversation-history::-webkit-scrollbar-track {
      background: #f9fafb;
    }

    .conversation-history::-webkit-scrollbar-thumb {
      background: #d1d5db;
      border-radius: 3px;
    }

    .conversation-item {
      padding: 12px 15px;
      margin-bottom: 8px;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      opacity: 0;
      animation: slideInLeft 0.5s ease forwards;
      border: 1px solid transparent;
    }

    .conversation-item:hover {
      background: #f8f9fa;
      border-color: #e5e7eb;
      transform: translateX(3px);
    }

    .conversation-item.active {
      background: linear-gradient(135deg, #dc8d32, #f4a942);
      color: white;
      border-color: #dc8d32;
    }

    .conversation-title {
      font-size: 14px;
      font-weight: 500;
      margin-bottom: 4px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .conversation-time {
      font-size: 11px;
      color: #6b7280;
    }

    .conversation-item.active .conversation-time {
      color: rgba(255,255,255,0.8);
    }

    .delete-conversation {
      position: absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      background: none;
      border: none;
      color: #9ca3af;
      cursor: pointer;
      opacity: 0;
      transition: all 0.3s ease;
      font-size: 16px;
    }

    .conversation-item:hover .delete-conversation {
      opacity: 1;
    }

    .delete-conversation:hover {
      color: #ef4444;
    }

    /* ë©”ë‰´ ì„¹ì…˜ */
    .menu-section {
      border-top: 1px solid #e5e7eb;
      padding: 20px;
      background: #fafafa;
    }

    .menu-title {
      color: #6b7280;
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 15px;
    }

    .nav-menu {
      list-style: none;
    }

    .nav-item {
      margin-bottom: 8px;
    }

    .nav-link {
      display: block;
      padding: 12px 15px;
      color: #374151;
      text-decoration: none;
      border-radius: 8px;
      transition: all 0.3s ease;
      cursor: pointer;
      font-size: 14px;
      border: 1px solid transparent;
    }

    .nav-link:hover {
      background: white;
      border-color: #e5e7eb;
      color: #0f2e69;
      transform: translateX(3px);
    }

    /* ë©”ì¸ ì»¨í…Œì´ë„ˆ */
    .main-container {
      margin-left: 0;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      overflow-x: hidden; /* ê°€ë¡œ ìŠ¤í¬ë¡¤ ë°©ì§€ */
    }

    .main-container.sidebar-open {
      margin-left: 320px;
    }

    /* í—¤ë” */
    .header {
      background: white;
      padding: 15px 30px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: fixed; /* í—¤ë”ë¥¼ ê³ ì • */
      top: 0;
      left: 0;
      right: 0;
      z-index: 100;
      height: 70px;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .main-container.sidebar-open .header {
      left: 320px; /* ì‚¬ì´ë“œë°”ê°€ ì—´ë¦´ ë•Œ í—¤ë”ë„ ì´ë™ */
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .menu-toggle {
      background: none;
      border: none;
      font-size: 20px;
      cursor: pointer;
      color: #374151;
      padding: 8px;
      border-radius: 8px;
      transition: all 0.3s ease;
    }

    .menu-toggle:hover {
      background: #f3f4f6;
      color: #0f2e69;
    }

    .hyundai-logo {
      height: 35px;
      background: linear-gradient(135deg, #ff8c00, #ffa500);
      padding: 8px 16px;
      border-radius: 8px;
      color: white;
      font-weight: 700;
      font-size: 14px;
      display: flex;
      align-items: center;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .hyundai-logo:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 15px rgba(255, 140, 0, 0.3);
    }

    .service-name {
      color: #0f2e69;
      font-size: 18px;
      font-weight: 600;
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .user-info {
      color: #6b7280;
      font-size: 14px;
      padding: 8px 16px;
      background: #f8f9fa;
      border-radius: 20px;
      border: 1px solid #e5e7eb;
    }

    .mypage-btn {
      background: white;
      color: #0f2e69;
      border: 1px solid #e5e7eb;
      padding: 8px 16px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      transition: all 0.3s ease;
    }

    .mypage-btn:hover {
      background: #f8f9fa;
      border-color: #0f2e69;
    }

    .logout-btn {
      background: linear-gradient(135deg, #dc8d32, #f4a942);
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      transition: all 0.3s ease;
    }

    .logout-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 15px rgba(220, 141, 50, 0.3);
    }

    /* í˜ì´ì§€ ì»¨í…Œì´ë„ˆ */
    .page-container {
      flex: 1;
      display: flex;
      flex-direction: column;
      position: relative;
      margin-top: 70px; /* í—¤ë” ë†’ì´ë§Œí¼ ë§ˆì§„ ì¶”ê°€ */
    }

    /* ëœë”©í˜ì´ì§€ */
    .landing-page {
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: calc(100vh - 70px);
      padding: 40px 30px;
      text-align: center;
      opacity: 1;
      transform: translateY(0);
      transition: all 0.6s ease;
      position: relative;
      z-index: 80;
      background: #fafafa;
    }

    .landing-page.hidden {
      opacity: 0;
      transform: translateY(-30px);
      pointer-events: none;
      display: none; /* ì™„ì „íˆ ìˆ¨ê¹€ */
    }

    .ai-badge {
      display: inline-block;
      background: linear-gradient(135deg, #dc8d32, #f4a942);
      color: white;
      padding: 10px 25px;
      border-radius: 30px;
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 30px;
      animation: pulse 2s infinite;
      box-shadow: 0 4px 20px rgba(220, 141, 50, 0.3);
    }

    .main-title {
      font-size: 48px;
      font-weight: 700;
      color: #0f2e69;
      margin-bottom: 20px;
      line-height: 1.2;
      animation: fadeInUp 0.8s ease;
    }

    .highlight {
      background: linear-gradient(135deg, #dc8d32, #f4a942);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .main-description {
      font-size: 18px;
      color: #6b7280;
      margin-bottom: 40px;
      max-width: 600px;
      animation: fadeInUp 0.8s ease 0.2s both;
    }

    /* ê²€ìƒ‰ ì„¹ì…˜ - ì±—ë´‡ ìŠ¤íƒ€ì¼ ì¤„ì„ */
    .search-section {
      background: white;
      padding: 30px;
      border-radius: 20px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.1);
      margin-bottom: 60px;
      max-width: 700px;
      width: 100%;
      animation: fadeInUp 0.8s ease 0.4s both;
      border: 1px solid #e5e7eb;
    }

    .search-container {
      display: flex;
      gap: 15px;
    }

    .search-input {
      flex: 1;
      padding: 16px 20px;
      border: 2px solid #e5e7eb;
      border-radius: 12px;
      font-size: 16px;
      outline: none;
      transition: all 0.3s ease;
      background: #fafafa;
      font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif;
    }

    .search-input:focus {
      border-color: #dc8d32;
      background: white;
      box-shadow: 0 0 0 3px rgba(220, 141, 50, 0.1);
    }

    .search-btn {
      background: linear-gradient(135deg, #dc8d32, #f4a942);
      color: white;
      border: none;
      padding: 16px 28px;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      white-space: nowrap;
      font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif;
    }

    .search-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(220, 141, 50, 0.3);
    }

    /* í˜„ì—… ë‹ˆì¦ˆ ì„¹ì…˜ */
    .business-sections {
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    .section-title {
      font-size: 28px;
      font-weight: 700;
      color: #0f2e69;
      margin-bottom: 30px;
      text-align: left;
    }

    /* ì˜¤ëŠ˜ì˜ ì£¼ìš” ë³€ê²½ì‚¬í•­ */
    .daily-updates {
      margin-bottom: 60px;
    }

    .update-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .update-card {
      background: white;
      border: 1px solid #e5e7eb;
      border-radius: 16px;
      padding: 24px;
      transition: all 0.3s ease;
      cursor: pointer;
      position: relative;
      overflow: hidden;
    }

    .update-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 40px rgba(0,0,0,0.1);
      border-color: #dc8d32;
    }

    .update-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 4px;
      height: 100%;
      background: linear-gradient(135deg, #dc8d32, #f4a942);
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 16px;
    }

    .card-category {
      background: #f0f9ff;
      color: #0f2e69;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
    }

    .card-impact {
      padding: 4px 8px;
      border-radius: 6px;
      font-size: 11px;
      font-weight: 600;
    }

    .card-impact.high {
      background: #fef2f2;
      color: #dc2626;
    }

    .card-impact.medium {
      background: #fefbf2;
      color: #d97706;
    }

    .card-title {
      font-size: 16px;
      font-weight: 600;
      color: #1f2937;
      margin-bottom: 12px;
      line-height: 1.4;
    }

    .card-summary {
      font-size: 14px;
      color: #6b7280;
      margin-bottom: 16px;
      line-height: 1.5;
    }

    .card-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 12px;
      color: #9ca3af;
    }

    .effect-date {
      font-weight: 600;
      color: #dc8d32;
    }

    /* ì£¼ê°„ ë³´ê³ ì„œ */
    .weekly-reports {
      margin-bottom: 40px;
    }

    .report-list {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .report-item {
      background: white;
      border: 1px solid #e5e7eb;
      border-radius: 12px;
      padding: 20px;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .report-item:hover {
      transform: translateX(4px);
      border-color: #dc8d32;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    }

    .report-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 12px;
    }

    .report-title {
      font-size: 16px;
      font-weight: 600;
      color: #1f2937;
      flex: 1;
    }

    .report-date {
      font-size: 12px;
      color: #6b7280;
      background: #f8f9fa;
      padding: 4px 8px;
      border-radius: 6px;
    }

    .report-summary {
      font-size: 14px;
      color: #6b7280;
      line-height: 1.5;
    }

    /* ì±„íŒ… í˜ì´ì§€ - ìˆ˜ì •ëœ UI */
    .chat-page {
      display: none;
      position: fixed;
      top: 70px;
      left: 0;
      right: 0;
      bottom: 0;
      opacity: 0;
      transition: opacity 0.6s ease, left 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      z-index: 90;
      background: #fafafa;
    }

    .main-container.sidebar-open .chat-page {
      left: 320px;
    }

    .chat-page.active {
      display: flex;
      flex-direction: column;
      opacity: 1;
    }

    /* ì±„íŒ… ë©”ì‹œì§€ ì˜ì—­ */
    .chat-messages {
      flex: 1;
      overflow-y: auto;
      padding: 0;
      scroll-behavior: smooth;
      background: #fafafa;
      position: relative;
    }

    .messages-container {
      max-width: 900px; /* ë„“ê²Œ ì¡°ì • */
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      gap: 24px; /* ê°„ê²© í™•ëŒ€ */
      padding: 24px;
      min-height: 100%;
      box-sizing: border-box;
    }

    /* ë©”ì‹œì§€ ìŠ¤íƒ€ì¼ ìˆ˜ì • */
    .message {
      opacity: 0;
      animation: messageSlideIn 0.5s ease forwards;
    }

    .message.user {
      align-self: flex-end;
    }

    .message.ai {
      align-self: stretch; /* AI ë©”ì‹œì§€ëŠ” ì „ì²´ ë„ˆë¹„ ì‚¬ìš© */
    }

    /* ì‚¬ìš©ì ë©”ì‹œì§€ ìŠ¤íƒ€ì¼ */
    .message-content {
      max-width: 80%; /* ì‚¬ìš©ì ë©”ì‹œì§€ ë„ˆë¹„ í™•ëŒ€ */
      padding: 16px 20px;
      border-radius: 18px;
      position: relative;
      word-wrap: break-word;
      font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif;
    }

    /* ì‚¬ìš©ì ë©”ì‹œì§€ ìŠ¤íƒ€ì¼ ìˆ˜ì • - ë” ë„“ê²Œ */
.message.user .message-content {
  background: linear-gradient(135deg, #dc8d32, #f4a942);
  color: white;
  border-bottom-right-radius: 6px;
  max-width: 90%; /* 80%ì—ì„œ 90%ë¡œ í™•ì¥ */
  width: auto; /* ë‚´ìš©ì— ë§ê²Œ ìë™ ì¡°ì • */
  min-width: 200px; /* ìµœì†Œ ë„ˆë¹„ ì„¤ì • */
}


    /* AI ë©”ì‹œì§€ ìŠ¤íƒ€ì¼ ë³€ê²½ - ë§í’ì„  ì—†ì´ ì „ì²´ ê³µê°„ í™œìš© */
    .message.ai .message-content {
      background: white;
      color: #374151;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      max-width: 100%; /* ì „ì²´ ë„ˆë¹„ ì‚¬ìš© */
      border-left: 4px solid #dc8d32; /* ì™¼ìª½ì— ê°•ì¡°ì„  ì¶”ê°€ */
      padding: 20px 24px; /* íŒ¨ë”© í™•ëŒ€ */
    }

    .message-time {
      font-size: 11px;
      color: rgba(255,255,255,0.7);
      margin-top: 6px;
    }

    .message.ai .message-time {
      color: #9ca3af;
    }

    /* ê·¼ê±° ì›ë¬¸ í‘œì‹œ ìŠ¤íƒ€ì¼ */
    .source-reference {
      margin-top: 16px;
      padding-top: 16px;
      border-top: 1px solid #e5e7eb;
    }

    .source-title {
      font-size: 13px;
      font-weight: 600;
      color: #0f2e69;
      margin-bottom: 8px;
    }

    .source-content {
      background: #f8f9fa;
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      padding: 12px;
      font-size: 14px;
      color: #4b5563;
      margin-bottom: 12px;
      position: relative;
    }

    .source-link {
      font-size: 12px;
      color: #dc8d32;
      text-decoration: none;
      display: block;
      margin-top: 8px;
    }

    .source-link:hover {
      text-decoration: underline;
    }

    /* ì±„íŒ… ì…ë ¥ì°½ - ê¸€ê¼´ ìˆ˜ì • */
    .chat-input-container {
      background: white;
      border-top: 1px solid #e5e7eb;
      padding: 20px;
      flex-shrink: 0;
      position: relative;
      z-index: 95;
    }

    .chat-input-wrapper {
      max-width: 900px; /* ë©”ì‹œì§€ ì»¨í…Œì´ë„ˆì™€ ë™ì¼í•˜ê²Œ ì¡°ì • */
      margin: 0 auto;
      display: flex;
      gap: 12px;
      align-items: flex-end;
    }

    .chat-input {
      flex: 1;
      padding: 14px 18px;
      border: 1px solid #e5e7eb;
      border-radius: 12px;
      font-size: 16px;
      outline: none;
      resize: none;
      min-height: 48px;
      max-height: 120px;
      transition: all 0.3s ease;
      background: #fafafa;
      font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif !important;
    }

    .chat-input:focus {
      border-color: #dc8d32;
      background: white;
      box-shadow: 0 0 0 3px rgba(220, 141, 50, 0.1);
    }

    .send-btn {
      background: linear-gradient(135deg, #dc8d32, #f4a942);
      color: white;
      border: none;
      padding: 14px 22px;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 500;
      height: 48px;
      flex-shrink: 0;
      font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif;
    }

    .send-btn:hover:not(:disabled) {
      transform: translateY(-1px);
      box-shadow: 0 4px 15px rgba(220, 141, 50, 0.3);
    }

    .send-btn:disabled {
      background: #d1d5db;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    /* íƒ€ì´í•‘ ì¸ë””ì¼€ì´í„° */
    .typing-indicator {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 16px 20px;
      background: white;
      border: 1px solid #e5e7eb;
      border-radius: 18px;
      border-bottom-left-radius: 6px;
      max-width: 70%;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }

    .typing-dots {
      display: flex;
      gap: 4px;
    }

    .typing-dot {
      width: 8px;
      height: 8px;
      background: #dc8d32;
      border-radius: 50%;
      animation: typingDot 1.4s infinite ease-in-out;
    }

    .typing-dot:nth-child(2) { animation-delay: 0.2s; }
    .typing-dot:nth-child(3) { animation-delay: 0.4s; }

    /* ì˜¤ë²„ë ˆì´ */
    .sidebar-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.3);
      z-index: 999;
      backdrop-filter: blur(2px);
    }

    .sidebar-overlay.active {
      display: block;
    }

    /* ì±„íŒ… í˜ì´ì§€ í™œì„±í™” ì‹œ body ìŠ¤í¬ë¡¤ ë°©ì§€ */
    body.chat-active {
      overflow: hidden;
    }

    /* ì•± ìƒíƒœì— ë”°ë¥¸ í‘œì‹œ/ìˆ¨ê¹€ ì²˜ë¦¬ */
    .app-container {
      display: none;
    }
    
    .app-container.active {
      display: block;
    }

    /* ì• ë‹ˆë©”ì´ì…˜ */
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes slideInLeft {
      from { opacity: 0; transform: translateX(-20px); }
      to { opacity: 1; transform: translateX(0); }
    }

    @keyframes messageSlideIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    @keyframes typingDot {
      0%, 60%, 100% { transform: scale(1); opacity: 0.5; }
      30% { transform: scale(1.2); opacity: 1; }
    }

    /* ë°˜ì‘í˜• */
    @media (max-width: 768px) {
      .sidebar { width: 280px; }
      .main-container.sidebar-open { margin-left: 0; }
      .main-container.sidebar-open .header,
      .main-container.sidebar-open .chat-page { left: 0; }
      .main-title { font-size: 36px; }
      .search-container { flex-direction: column; }
      .message-content { max-width: 85%; }
      .header { padding: 15px 20px; }
      .service-name { font-size: 16px; }
      .update-cards { grid-template-columns: 1fr; }
      .business-sections { padding: 0 15px; }
    }
  </style>
</head>
<body>
  <!-- ë¡œê·¸ì¸ í˜ì´ì§€ -->
  <div class="app-container active" id="loginPage">
    <div class="login-page">
      <div class="login-container">
        <div class="logo">
          <div class="hyundai-badge">í˜„ëŒ€í•´ìƒ</div>
          <h1>Hi-PolicyLens</h1>
          <p>ì •ì±…/ê·œì œë¥¼ ë Œì¦ˆì²˜ëŸ¼ í™•ëŒ€Â·ì •í™•íˆ ë³´ì—¬ì¤Œ</p>
        </div>
        
        <div class="login-form">
          <div class="form-group">
            <label for="email" class="form-label">ì´ë©”ì¼</label>
            <input type="email" id="email" class="form-input" placeholder="name@company.com" value="yongju.cho@hyundai.com">
          </div>
          
          <div class="form-group">
            <label for="password" class="form-label">ë¹„ë°€ë²ˆí˜¸</label>
            <input type="password" id="password" class="form-input" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥" value="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢">
          </div>
          
          <button class="login-btn" onclick="login()">ë¡œê·¸ì¸</button>
          
          <p class="help-text">
            ê³„ì •ì´ ì—†ìœ¼ì‹ ê°€ìš”? <a href="#">íšŒì›ê°€ì…</a> ë˜ëŠ” <a href="#">ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°</a>
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- ë©”ì¸ ì•± -->
  <div class="app-container" id="mainApp">
    <!-- ì‚¬ì´ë“œë°” ì˜¤ë²„ë ˆì´ -->
    <div class="sidebar-overlay" onclick="closeSidebar()"></div>

    <!-- ì‚¬ì´ë“œë°” -->
    <nav class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-logo">
          <h2>Hi-PolicyLens</h2>
          <div class="sidebar-subtitle">ì •ì±…/ê·œì œë¥¼ ë Œì¦ˆì²˜ëŸ¼ í™•ëŒ€Â·ì •í™•íˆ ë³´ì—¬ì¤Œ</div>
        </div>
        <button class="sidebar-close" onclick="closeSidebar()">Ã—</button>
      </div>
      
      <button class="new-chat-btn" onclick="startNewChat()">+ ìƒˆë¡œìš´ ëŒ€í™”</button>
      <button class="home-btn" onclick="goToHome()">ğŸ  í™ˆìœ¼ë¡œ ì´ë™</button>
      
      <div class="conversation-history" id="conversationHistory">
        <!-- ëŒ€í™” íˆìŠ¤í† ë¦¬ê°€ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
      </div>
      
      <div class="menu-section">
        <div class="menu-title">ë„êµ¬</div>
        <ul class="nav-menu">
          <li class="nav-item">
            <a href="#" class="nav-link" onclick="redirectToTool('dashboard')">ğŸ“Š ê²€ìƒ‰ ê¸°ë°˜ ë¶„ì„ ëŒ€ì‹œë³´ë“œ</a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link" onclick="redirectToTool('reports')">ğŸ“‹ ë³´ê³ ì„œ ìš”ì•½ ì¹´ë“œ</a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link" onclick="redirectToTool('compare')">ğŸ” êµ­ë‚´ì™¸ì˜ ê·œì œ ë¹„êµë¶„ì„</a>
          </li>
        </ul>
      </div>
    </nav>

    <!-- ë©”ì¸ ì»¨í…Œì´ë„ˆ -->
    <div class="main-container" id="mainContainer">
      <!-- í—¤ë” -->
      <header class="header">
        <div class="header-left">
          <button class="menu-toggle" onclick="toggleSidebar()">â˜°</button>
          <div class="hyundai-logo" onclick="goToHome()">í˜„ëŒ€í•´ìƒ</div>
          <span class="service-name">Hi-PolicyLens - ì •ì±…/ê·œì œ ëª¨ë‹ˆí„°ë§</span>
        </div>
        <div class="header-right">
          <span class="user-info">ì•ˆë…•í•˜ì„¸ìš”, ì¡°ìœ¤ì£¼ë‹˜</span>
          <button class="mypage-btn" onclick="goToMyPage()">ë§ˆì´í˜ì´ì§€</button>
          <button class="logout-btn" onclick="logout()">ë¡œê·¸ì•„ì›ƒ</button>
        </div>
      </header>

      <!-- í˜ì´ì§€ ì»¨í…Œì´ë„ˆ -->
      <div class="page-container">
        <!-- ëœë”©í˜ì´ì§€ -->
        <div class="landing-page" id="landingPage">
          <div class="ai-badge">âš¡ AI ê¸°ë°˜ ì •ì±…/ê·œì œ ë¶„ì„ ì†”ë£¨ì…˜</div>
          
          <h1 class="main-title">
            ì¸í”„ë¼ íˆ¬ì ì •ì±…ê³¼ ê·œì œë¥¼<br>
            <span class="highlight">í™•ëŒ€Â·ì •í™•íˆ ë³´ì—¬ë“œë¦½ë‹ˆë‹¤</span>
          </h1>
          
          <p class="main-description">
            ì •ì±…ë¶€í„° êµ­ë‚´ì™¸ ê·œì œ ë³€í™”ê¹Œì§€, ë³µì¡í•œ ê·œì œ í™˜ê²½ì„ Hi-PolicyLensê°€ ë„ì™€ë“œë¦¬ê² ìŠµë‹ˆë‹¤.
          </p>

          <!-- ê²€ìƒ‰ ì„¹ì…˜ -->
          <div class="search-section">
            <div class="search-container">
              <input 
                type="text" 
                class="search-input" 
                id="searchInput"
                placeholder="ì˜ˆ: êµ­ë‚´ í•´ì™¸ í’ë ¥ë°œì „ ê·œì œ ë¹„êµí•´ì¤˜"
              >
              <button class="search-btn" id="searchBtn" onclick="startAnalysis()">ë¶„ì„ ì‹œì‘</button>
            </div>
          </div>

          <!-- í˜„ì—… ë‹ˆì¦ˆ ì„¹ì…˜ -->
          <div class="business-sections">
            <!-- ì˜¤ëŠ˜ì˜ ì£¼ìš” ë³€ê²½ì‚¬í•­ -->
            <div class="daily-updates">
              <h2 class="section-title">ğŸ“‹ ì˜¤ëŠ˜ì˜ ì£¼ìš” ë³€ê²½ì‚¬í•­</h2>
              <div class="update-cards" id="dailyUpdateCards">
                <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
              </div>
            </div>

            <!-- ì¼ì£¼ì¼ ë‚´ ì‹ ê·œ ì—…ë°ì´íŠ¸ ë³´ê³ ì„œ -->
            <div class="weekly-reports">
              <h2 class="section-title">ğŸ“Š ì¼ì£¼ì¼ ë‚´ ì‹ ê·œ ì—…ë°ì´íŠ¸ ë³´ê³ ì„œ</h2>
              <div class="report-list" id="weeklyReportList">
                <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
              </div>
            </div>
          </div>
        </div>

        <!-- ì±„íŒ… í˜ì´ì§€ -->
        <div class="chat-page" id="chatPage">
          <!-- ë©”ì‹œì§€ ì˜ì—­ -->
          <div class="chat-messages" id="chatMessages">
            <div class="messages-container" id="messagesContainer">
              <!-- ë©”ì‹œì§€ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
            </div>
          </div>
          
          <!-- ì…ë ¥ì°½ -->
          <div class="chat-input-container">
            <div class="chat-input-wrapper">
              <textarea 
                class="chat-input" 
                id="chatInput"
                placeholder="ì¶”ê°€ ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”..."
                rows="1"
              ></textarea>
              <button class="send-btn" id="sendBtn" onclick="sendMessage()">ì „ì†¡</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ë¡œê·¸ì¸ í•¨ìˆ˜
    function login() {
      document.getElementById('loginPage').classList.remove('active');
      document.getElementById('mainApp').classList.add('active');
      
      // ë©”ì¸ ì•± ì´ˆê¸°í™”
      initMainApp();
    }
    
    // ë¡œê·¸ì•„ì›ƒ í•¨ìˆ˜
    function logout() {
      if (confirm('ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        document.getElementById('mainApp').classList.remove('active');
        document.getElementById('loginPage').classList.add('active');
      }
    }
    
    // ë©”ì¸ ì•± ì´ˆê¸°í™”
    function initMainApp() {
      // ê¸°ì¡´ ì´ˆê¸°í™” ì½”ë“œ
      loadConversations();
      loadDailyUpdates();
      loadWeeklyReports();
      setupEventListeners();
    }
    
    // ì „ì—­ ë³€ìˆ˜
    let currentConversationId = null;
    let conversations = [];
    let isTyping = false;

    // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
    function setupEventListeners() {
      const searchInput = document.getElementById('searchInput');
      searchInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter' && !e.shiftKey) {
          e.preventDefault();
          startAnalysis();
        }
      });

      const chatInput = document.getElementById('chatInput');
      chatInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter' && !e.shiftKey) {
          e.preventDefault();
          sendMessage();
        }
      });

      chatInput.addEventListener('input', function() {
        this.style.height = 'auto';
        this.style.height = Math.min(this.scrollHeight, 120) + 'px';
      });
    }

    function toggleSidebar() {
      const sidebar = document.getElementById('sidebar');
      const overlay = document.querySelector('.sidebar-overlay');
      const mainContainer = document.getElementById('mainContainer');
      
      sidebar.classList.add('active');
      overlay.classList.add('active');
      
      if (window.innerWidth > 768) {
        mainContainer.classList.add('sidebar-open');
      }
    }

    function closeSidebar() {
      const sidebar = document.getElementById('sidebar');
      const overlay = document.querySelector('.sidebar-overlay');
      const mainContainer = document.getElementById('mainContainer');
      
      sidebar.classList.remove('active');
      overlay.classList.remove('active');
      mainContainer.classList.remove('sidebar-open');
    }

    function startNewChat() {
      currentConversationId = null;
      showLandingPage();
      updateConversationHistory();
      closeSidebar();
    }

    function goToHome() {
      currentConversationId = null;
      showLandingPage();
      closeSidebar();
    }

    function showLandingPage() {
      const landingPage = document.getElementById('landingPage');
      const chatPage = document.getElementById('chatPage');
      
      chatPage.classList.remove('active');
      document.body.classList.remove('chat-active');
      
      setTimeout(() => {
        landingPage.classList.remove('hidden');
      }, 300);
    }

    function showChatPage() {
      const landingPage = document.getElementById('landingPage');
      const chatPage = document.getElementById('chatPage');
      
      landingPage.classList.add('hidden');
      document.body.classList.add('chat-active');
      
      setTimeout(() => {
        chatPage.classList.add('active');
        const messagesContainer = document.getElementById('messagesContainer');
        messagesContainer.innerHTML = '';
      }, 300);
    }

    function startAnalysis() {
      const searchInput = document.getElementById('searchInput');
      const query = searchInput.value.trim();
      
      if (!query) {
        alert('ì§ˆë¬¸ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        return;
      }
      
      showChatPage();
      setTimeout(() => {
        addMessage('user', query);
        callAnalysisAPI(query);
      }, 600);
    }

    function addMessage(type, content, animate = true, sources = []) {
      const messagesContainer = document.getElementById('messagesContainer');
      const messageDiv = document.createElement('div');
      messageDiv.className = `message ${type}`;
      
      const now = new Date();
      const timeString = now.toLocaleTimeString('ko-KR', { 
        hour: '2-digit', 
        minute: '2-digit' 
      });
      
      // ê·¼ê±° ì›ë¬¸ HTML ìƒì„±
      let sourcesHtml = '';
      if (type === 'ai' && sources && sources.length > 0) {
        sourcesHtml = `
          <div class="source-reference">
            <div class="source-title">ğŸ“š ì°¸ê³  ìë£Œ</div>
            ${sources.map(source => `
              <div class="source-content">
                ${source.content}
                <a href="${source.link}" target="_blank" class="source-link">ì¶œì²˜: ${source.title}</a>
              </div>
            `).join('')}
          </div>
        `;
      }
      
      messageDiv.innerHTML = `
        <div class="message-content">
          ${formatMessage(content)}
          <div class="message-time">${timeString}</div>
          ${sourcesHtml}
        </div>
      `;
      
      messagesContainer.appendChild(messageDiv);
      
      // ìŠ¤í¬ë¡¤ì„ ìµœí•˜ë‹¨ìœ¼ë¡œ
      const chatMessages = document.getElementById('chatMessages');
      chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    function showTypingIndicator() {
      const messagesContainer = document.getElementById('messagesContainer');
      const typingDiv = document.createElement('div');
      typingDiv.className = 'message ai';
      typingDiv.id = 'typingIndicator';
      
      typingDiv.innerHTML = `
        <div class="typing-indicator">
          <div class="typing-dots">
            <div class="typing-dot"></div>
            <div class="typing-dot"></div>
            <div class="typing-dot"></div>
          </div>
          <span>Hi-PolicyLens AIê°€ ë¶„ì„ ì¤‘...</span>
        </div>
      `;
      
      messagesContainer.appendChild(typingDiv);
      
      const chatMessages = document.getElementById('chatMessages');
      chatMessages.scrollTop = chatMessages.scrollHeight;
      
      isTyping = true;
    }

    function hideTypingIndicator() {
      const typingIndicator = document.getElementById('typingIndicator');
      if (typingIndicator) {
        typingIndicator.remove();
      }
      isTyping = false;
    }

    function formatMessage(content) {
      return content
        .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
        .replace(/\*(.*?)\*/g, '<em>$1</em>')
        .replace(/##\s*(.*?)$/gm, '<h3 style="color: #0f2e69; margin: 20px 0 10px 0; font-size: 18px;">$1</h3>')
        .replace(/\n/g, '<br>');
    }

    function callAnalysisAPI(query) {
      showTypingIndicator();
      
      google.script.run
        .withSuccessHandler(onAnalysisSuccess)
        .withFailureHandler(onAnalysisFailure)
        .analyzeRegulation(query, currentConversationId);
    }

    function sendMessage() {
      const chatInput = document.getElementById('chatInput');
      const message = chatInput.value.trim();
      
      if (!message || isTyping) return;
      
      addMessage('user', message);
      chatInput.value = '';
      chatInput.style.height = 'auto';
      
      if (currentConversationId) {
        showTypingIndicator();
        google.script.run
          .withSuccessHandler(onAnalysisSuccess)
          .withFailureHandler(onAnalysisFailure)
          .continueConversation(currentConversationId, message);
      } else {
        callAnalysisAPI(message);
      }
    }

    function onAnalysisSuccess(result) {
  hideTypingIndicator();
  
  if (result && result.success) {
    let aiResponse = '';
    
    if (result.data && result.data.response) {
      aiResponse = result.data.response;
    } else {
      aiResponse = 'ì£„ì†¡í•©ë‹ˆë‹¤. ì‘ë‹µì„ ì²˜ë¦¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
    }
    
    // ì˜ˆì‹œ ê·¼ê±° ì›ë¬¸
    const sources = [
      {
        title: 'ì‹ ì¬ìƒì—ë„ˆì§€ë²• ì œ12ì¡°',
        content: 'ì‹ ì¬ìƒì—ë„ˆì§€ ê³µê¸‰ ì˜ë¬´í™”ì œë„(RPS)ì— ë”°ë¼ ë°œì „ì‚¬ì—…ìëŠ” ì´ ë°œì „ëŸ‰ì˜ ì¼ì • ë¹„ìœ¨ ì´ìƒì„ ì‹ ì¬ìƒì—ë„ˆì§€ë¡œ ê³µê¸‰í•´ì•¼ í•œë‹¤.',
        link: 'https://www.law.go.kr'
      }
    ];
    
    addMessage('ai', aiResponse, true, sources);
    
    if (result.conversation) {
      currentConversationId = result.conversation.id;
      loadConversations();
    }
  } else {
    addMessage('ai', 'ì£„ì†¡í•©ë‹ˆë‹¤. ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
  }
}

function onAnalysisFailure(error) {
  hideTypingIndicator();
  console.error('API í˜¸ì¶œ ì‹¤íŒ¨:', error);
  
  // ëŒ€ì²´ ì‘ë‹µ ì œê³µ
  const fallbackMessage = `í˜„ì¬ AI ì„œë¹„ìŠ¤ì— ì¼ì‹œì ì¸ ë¬¸ì œê°€ ìˆìŠµë‹ˆë‹¤. 

**ì¼ë°˜ì ì¸ ì¸í”„ë¼ íˆ¬ì ê°€ì´ë“œë¼ì¸:**
- ì •ë¶€ ì •ì±… ë°©í–¥ì„± ê²€í†  (ê·¸ë¦°ë‰´ë”œ, ë””ì§€í„¸ë‰´ë”œ)
- ê´€ë ¨ ë²•ê·œ ë° ì¸í—ˆê°€ ìš”ê±´ í™•ì¸
- ì¥ê¸° ìˆ˜ìµì„± ë° ë¦¬ìŠ¤í¬ ë¶„ì„
- ESG í‰ê°€ ê¸°ì¤€ ë¶€í•©ì„± ê²€í† 

ìì„¸í•œ ë¶„ì„ì´ í•„ìš”í•˜ì‹œë©´ ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.`;
  
  addMessage('ai', fallbackMessage);
}


    function onAnalysisFailure(error) {
      hideTypingIndicator();
      addMessage('ai', 'ì£„ì†¡í•©ë‹ˆë‹¤. ì„œë²„ì™€ì˜ ì—°ê²°ì— ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
      console.error('API í˜¸ì¶œ ì‹¤íŒ¨:', error);
    }

    function loadConversations() {
      google.script.run
        .withSuccessHandler(updateConversationHistory)
        .withFailureHandler(() => console.error('ëŒ€í™” íˆìŠ¤í† ë¦¬ ë¡œë“œ ì‹¤íŒ¨'))
        .getConversations();
    }

    function updateConversationHistory(conversationList = []) {
      const historyContainer = document.getElementById('conversationHistory');
      historyContainer.innerHTML = '';
      
      conversations = conversationList;
      
      conversations.forEach((conv, index) => {
        const convDiv = document.createElement('div');
        convDiv.className = `conversation-item ${conv.id === currentConversationId ? 'active' : ''}`;
        convDiv.style.animationDelay = `${index * 0.1}s`;
        
        const timeAgo = getTimeAgo(new Date(conv.timestamp));
        
        convDiv.innerHTML = `
          <div class="conversation-title">${conv.title}</div>
          <div class="conversation-time">${timeAgo}</div>
          <button class="delete-conversation" onclick="deleteConversation('${conv.id}')" title="ëŒ€í™” ì‚­ì œ">Ã—</button>
        `;
        
        convDiv.onclick = (e) => {
          if (e.target.classList.contains('delete-conversation')) return;
          loadConversation(conv.id);
        };
        
        historyContainer.appendChild(convDiv);
      });
    }

    function loadConversation(conversationId) {
      google.script.run
        .withSuccessHandler((conversation) => {
          if (conversation) {
            currentConversationId = conversationId;
            showChatPage();
            
            setTimeout(() => {
              const messagesContainer = document.getElementById('messagesContainer');
              messagesContainer.innerHTML = '';
              
              addMessage('user', conversation.userMessage, false);
              setTimeout(() => {
                addMessage('ai', conversation.aiResponse, false);
              }, 500);
              
              updateConversationHistory(conversations);
            }, 600);
            
            closeSidebar();
          }
        })
        .withFailureHandler(() => alert('ëŒ€í™”ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.'))
        .getConversation(conversationId);
    }

    function deleteConversation(conversationId) {
      if (confirm('ì´ ëŒ€í™”ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        google.script.run
          .withSuccessHandler(() => {
            if (currentConversationId === conversationId) {
              currentConversationId = null;
              showLandingPage();
            }
            loadConversations();
          })
          .withFailureHandler(() => alert('ëŒ€í™” ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.'))
          .deleteConversation(conversationId);
      }
    }

    // ë°ì¼ë¦¬ ì—…ë°ì´íŠ¸ ë¡œë“œ
    function loadDailyUpdates() {
      google.script.run
        .withSuccessHandler(renderDailyUpdates)
        .withFailureHandler(() => console.error('ë°ì¼ë¦¬ ì—…ë°ì´íŠ¸ ë¡œë“œ ì‹¤íŒ¨'))
        .getTodayUpdates();
    }

    function renderDailyUpdates(updates) {
      const container = document.getElementById('dailyUpdateCards');
      container.innerHTML = '';
      
      updates.forEach((update, index) => {
        const card = document.createElement('div');
        card.className = 'update-card';
        card.style.animationDelay = `${index * 0.1}s`;
        
        card.innerHTML = `
          <div class="card-header">
            <div class="card-category">${update.category}</div>
            <div class="card-impact ${update.impact === 'ë†’ìŒ' ? 'high' : 'medium'}">${update.impact}</div>
          </div>
          <div class="card-title">${update.title}</div>
          <div class="card-summary">${update.summary}</div>
          <div class="card-footer">
            <span class="effect-date">ì‹œí–‰ì¼: ${update.effectDate}</span>
            <span>ì¶œì²˜: ${update.source}</span>
          </div>
        `;
        
        card.onclick = () => {
          showChatPage();
          setTimeout(() => {
            addMessage('user', `${update.title}ì— ëŒ€í•´ ìì„¸íˆ ë¶„ì„í•´ì£¼ì„¸ìš”.`);
            callAnalysisAPI(`${update.title}ì— ëŒ€í•œ ìƒì„¸ ë¶„ì„ê³¼ íˆ¬ì ì˜í–¥ë„ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”.`);
          }, 600);
        };
        
        container.appendChild(card);
      });
    }

    // ì£¼ê°„ ë³´ê³ ì„œ ë¡œë“œ
    function loadWeeklyReports() {
      google.script.run
        .withSuccessHandler(renderWeeklyReports)
        .withFailureHandler(() => console.error('ì£¼ê°„ ë³´ê³ ì„œ ë¡œë“œ ì‹¤íŒ¨'))
        .getWeeklyReports();
    }

    function renderWeeklyReports(reports) {
      const container = document.getElementById('weeklyReportList');
      container.innerHTML = '';
      
      reports.forEach((report, index) => {
        const item = document.createElement('div');
        item.className = 'report-item';
        item.style.animationDelay = `${index * 0.1}s`;
        
        item.innerHTML = `
          <div class="report-header">
            <div class="report-title">${report.title}</div>
            <div class="report-date">${report.date}</div>
          </div>
          <div class="report-summary">${report.summary}</div>
        `;
        
        item.onclick = () => {
          showChatPage();
          setTimeout(() => {
            addMessage('user', `${report.title}ì— ëŒ€í•´ ìì„¸íˆ ì•Œë ¤ì£¼ì„¸ìš”.`);
            callAnalysisAPI(`${report.title}ì˜ ì£¼ìš” ë‚´ìš©ê³¼ íˆ¬ì ì‹œì‚¬ì ì„ ë¶„ì„í•´ì£¼ì„¸ìš”.`);
          }, 600);
        };
        
        container.appendChild(item);
      });
    }

    function getTimeAgo(date) {
      const now = new Date();
      const diff = now - date;
      const minutes = Math.floor(diff / 60000);
      const hours = Math.floor(diff / 3600000);
      const days = Math.floor(diff / 86400000);
      
      if (minutes < 1) return 'ë°©ê¸ˆ ì „';
      if (minutes < 60) return `${minutes}ë¶„ ì „`;
      if (hours < 24) return `${hours}ì‹œê°„ ì „`;
      if (days < 7) return `${days}ì¼ ì „`;
      return date.toLocaleDateString('ko-KR');
    }

    function redirectToTool(tool) {
      closeSidebar();
      
      // íŒ€ì›ë“¤ì´ ë§Œë“  í˜ì´ì§€ URL ë§¤í•‘
      const toolUrls = {
        'dashboard': 'https://script.google.com/a/macros/gnu.ac.kr/s/AKfycbwVLz0AI_twh3wK0hIiYdEqjqyRN9-mWH16VJ3tSP_AwcEkM1qs4Xqv2z7s6zXVeruuVg/exec',
        'reports': 'https://script.google.com/macros/s/AKfycbwEwqUB5r6dN31OX0Xdc_HQj2bf_rvhT5684p-4zE_v_v-JqlPrT8z9fI6YmibV7VEy/exec',
        'compare': 'https://script.google.com/macros/s/AKfycbycZzr5UufyZHlw1Ot6-lzwpo83BMCQ596w9j3zvLzKESIj0CR0UvDpiCHVLA3BKCJVQA/exec'
      };
      
      const targetUrl = toolUrls[tool];
      
      if (targetUrl) {
        // ìƒˆ íƒ­ì—ì„œ ì—´ê¸° (ê¶Œì¥)
        window.open(targetUrl, '_blank');
      } else {
        console.error('í•´ë‹¹ ë„êµ¬ì˜ URLì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤:', tool);
        alert('ì£„ì†¡í•©ë‹ˆë‹¤. í•´ë‹¹ í˜ì´ì§€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
      }
    }

    function goToMyPage() {
      console.log('ë§ˆì´í˜ì´ì§€ë¡œ ì´ë™');
      // ë§ˆì´í˜ì´ì§€ êµ¬í˜„ ì˜ˆì •
    }

    // ë°˜ì‘í˜• ì²˜ë¦¬
    window.addEventListener('resize', function() {
      const mainContainer = document.getElementById('mainContainer');
      const sidebar = document.getElementById('sidebar');
      
      if (window.innerWidth <= 768) {
        mainContainer.classList.remove('sidebar-open');
      } else if (sidebar.classList.contains('active')) {
        mainContainer.classList.add('sidebar-open');
      }
    });
  </script>
</body>
</html>
